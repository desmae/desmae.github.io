<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GTI - Game Commands</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .command-section {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.5s ease forwards;
    }

    .items-section {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.5s ease forwards 0.3s;
      background: var(--card-bg-light);
      border-radius: 20px;
      padding: 2rem;
      margin-top: 3rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    body.dark-mode .items-section {
      background: var(--card-bg-dark);
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .table-container {
      overflow-x: auto;
      width: 100%;
    }

    .command-table {
      min-width: 600px;
    }
    /* Search bar improvements */
    .search-container {
      position: relative;
      max-width: 600px;
      margin: 2rem auto;
      font-family: 'Poppins', sans-serif;
    }

    .search-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: #888;
      font-size: 1.2rem;
    }

    #item-search {
      padding: 1rem 3rem;
      width: 100%;
      font-size: 1rem;
      border: 2px solid #eee;
      border-radius: 10px;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      background: rgba(255, 255, 255, 0.8);
    }

    #item-search:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 15px rgba(255, 154, 158, 0.2);
      background: rgba(255, 255, 255, 0.95);
    }

    /* Table Styling */
    #items-table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      margin-top: 2rem;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }

    #items-table th {
      background: var(--accent-color);
      color: white;
      padding: 1rem;
      text-align: left;
      font-weight: 600;
    }

    #items-table td {
      padding: 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      background: rgba(255, 255, 255, 0.6);
    }

    #items-table tr:last-child td {
      border-bottom: none;
    }

    #items-table tbody tr {
      opacity: 0;
      transform: translateY(10px);
      animation: slideInRow 0.3s ease forwards;
    }

    @keyframes slideInRow {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #items-table tbody tr:nth-child(even) td {
      background: rgba(255, 255, 255, 0.4);
    }

    #items-table tbody tr:hover td {
      background: rgba(255, 154, 158, 0.1);
    }

    /* Dark mode overrides */
    body.dark-mode .search-icon {
      color: #666;
    }

    body.dark-mode code {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-mode code:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    body.dark-mode #item-search {
      background: rgba(42, 42, 42, 0.9);
      border-color: #444;
      color: #e0e0e0;
    }

    body.dark-mode #item-search:focus {
      background: rgba(52, 52, 52, 0.95);
    }

    body.dark-mode #items-table td {
      background: rgba(42, 42, 42, 0.6);
      border-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-mode #items-table tbody tr:nth-child(even) td {
      background: rgba(42, 42, 42, 0.4);
    }

    body.dark-mode #items-table tbody tr:hover td {
      background: rgba(255, 255, 255, 0.05);
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">GTI Chat Bot</div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="commands.html">Commands</a></li>
      <li><a href="features.html">New Features</a></li>
      <li><a href="changelog.html">Changelog</a></li>
      <li><a href="teaser.html">Upcoming</a></li>
      <li><button id="dark-mode-toggle" class="dark-mode-btn">Dark Mode</button></li>
    </ul>
  </nav>
  
  <div class="container">
    <div class="command-section">
      <h1>Game Commands</h1>
      <table class="command-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Syntax</th>
            <th>Example</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="command-name">!guess</span></td>
            <td><code>!guess {item}</code> OR <code>!g {item}</code></td>
            <td><code>!guess fire arrows</code></td>
            <td><h4>Guess an item before it is obtained. You can change your guess after a one-minute cooldown.</h4></td>
          </tr>
          <tr>
            <td><span class="command-name">!guessdungeon</span></td>
            <td><code>!guessdungeon {dungeon}</code> OR <br> <code>!gd {dungeon}</code></td>
            <td><code>!guessdungeon Fire Temple</code></td>
            <td><h4>Guess a dungeon entrance before it is found. You can guess this ALONGSIDE regular guesses for extra points. (30 min cooldown)
            </td>
          </tr>
          <tr>
            <td><span class="command-name">!guessboss</span></td>
            <td><code>!guessboss {boss}</code> OR <br> <code>!gb {boss}</code></td>
            <td><code>!guessboss Bongo Bongo</code></td>
            <td><h4>Guess a boss entrance before it is found. You can guess this ALONGSIDE regular guesses for extra points. (30 min cooldown)
            </td>
          </tr>
          <tr>
            <td><span class="command-name">!myguess</span></td>
            <td><code>!myguess</code></td>
            <td><code>!myguess</code></td>
            <td><h4>Allows you to check your guess in case you forgot.</h4></td>
          </tr>
          <tr>
            <td><span class="command-name">!myscore</span></td>
            <td><code>!myscore</code></td>
            <td><code>!myscore</code></td>
            <td><h4>Allows you to check your score.</h4></td>
          </tr>
          <tr>
            <td><span class="command-name">!random</span></td>
            <td><code>!random</code></td>
            <td><code>!random</code></td>
            <td><h4>Randomly picks an item for you. Useful if you're new to the game!</h4></td>
          </tr>
          <tr>
            <td><span class="command-name">!anonymous</span></td>
            <td><code>!anonymous</code> OR <br> <code>!anonymous {newUsername}</code></td>
            <td><code>!anonymous FakeName50</code></td>
            <td><h4>Picks an anonymous name for you if you don't put one down for it to use instead. 
              You can only change your anonymous name once every 24 hours, but can toggle it on/off at any time using the !anonymous command.</h4>
            </td>
          </tr>
          <tr>
            <td><span class="command-name">!settext</span></td>
            <td><code>!settext {winnerText}</code></td>
            <td><code>!settext i won the game in ur face loser lol</code></td>
            <td><h4>Allows you to pick your 1st place text if you win! This will ONLY appear if you win the game.</h4>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="items-section">
      <h2>Guessable Items</h2>
      <div class="search-container">
        <span class="search-icon">üîç</span>
        <input type="text" id="item-search" placeholder="Search items by name or alias‚Ä¶" />
      </div>
      <table id="items-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Amount</th>
            <th>Aliases</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // Dark mode toggle script
    const toggleButton = document.getElementById('dark-mode-toggle');
  
    function enableDarkMode() {
      document.body.classList.add('dark-mode');
      localStorage.setItem('darkMode', 'enabled');  
      toggleButton.textContent = "Light Mode";
    }
  
    function disableDarkMode() {
      document.body.classList.remove('dark-mode');
      localStorage.setItem('darkMode', 'disabled');
      toggleButton.textContent = "Dark Mode";
    }
  
    if (localStorage.getItem('darkMode') === 'enabled') {
      enableDarkMode();
    }
  
    toggleButton.addEventListener('click', () => {
      if (document.body.classList.contains('dark-mode')) {
        disableDarkMode();
      } else {
        enableDarkMode();
      }
    });
  </script>
  
  <script>
    (async function() {
      const itemsUrl = './oot_data/items.json';
      console.log('Fetching items from:', itemsUrl);
      let data;
      try {
        const res = await fetch(itemsUrl);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        data = await res.json();
      } catch (err) {
        console.error('Failed to load items.json:', err);
        return;
      }
      const keyItems = Array.isArray(data.key_items) ? data.key_items : [];
      const midItems = Array.isArray(data.mid_items) ? data.mid_items : [];
      const nonKeyItems = Array.isArray(data.non_key_items) ? data.non_key_items : [];
      console.log(`Loaded items: key=${keyItems.length}, mid=${midItems.length}, non=${nonKeyItems.length}`);

      const rawItems = [...keyItems, ...midItems, ...nonKeyItems];
      const tbody = document.querySelector('#items-table tbody');
      const searchInput = document.getElementById('item-search');

      function render(list) {
        tbody.innerHTML = '';
        list.forEach((item, index) => {
          if (!item || typeof item !== 'object') return;
          
          const tr = document.createElement('tr');
          tr.style.animationDelay = `${index * 0.05}s`;
          
          const aliases = Array.isArray(item.aliases) ? item.aliases : [];
          const amount = item.hasOwnProperty('amount') ? item.amount : '‚àû';
          
          tr.innerHTML = `
            <td>${item.name || '(unnamed)'}</td>
            <td style="text-align: center;">${amount}</td>
            <td>${aliases.join(', ') || '-'}</td>
          `;
          tbody.appendChild(tr);
        });

        // If no items found, show a message
        if (list.length === 0) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td colspan="3" style="text-align: center; padding: 2rem;">
              No items found matching your search
            </td>
          `;
          tbody.appendChild(tr);
        }
      }

      const allItems = rawItems.map(item => {
        if (typeof item === 'string') {
          return { name: item, amount: '‚àû', aliases: [] };
        }
        return {
          name: item.name || '(no name)',
          amount: item.hasOwnProperty('amount') ? item.amount : '‚àû',
          aliases: Array.isArray(item.aliases) ? item.aliases : []
        };
      });
      render(allItems);

      let searchTimeout;
      searchInput.addEventListener('input', e => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          const query = e.target.value.trim().toLowerCase();
          const filtered = query === ''
            ? allItems
            : allItems.filter(item => {
                if (!item || typeof item !== 'object') return false;
                const nameMatch = (item.name || '').toLowerCase().includes(query);
                const aliasMatch = Array.isArray(item.aliases) && 
                  item.aliases.some(a => a.toLowerCase().includes(query));
                return nameMatch || aliasMatch;
              });
          render(filtered);
        }, 150);
      });
    })();
  </script>
</body>
</html>
